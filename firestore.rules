/**
 * Core Philosophy:
 * This ruleset enforces a public read-only model for the "Badman Tips" application.
 * Given that the application supports anonymous access without user sign-up, the primary
 * security goal is to expose prediction data for public consumption while strictly
 * preventing any client-side modifications. All data creation, updates, and deletions
 * are expected to be handled by a trusted backend service (e.g., a Cloud Function
 * with Admin SDK credentials), which bypasses these security rules.
 *
 * Data Structure:
 * All application data is stored in a single, top-level collection: `/predictions`.
 * There are no user-specific subcollections, as the application does not manage user accounts or private data.
 *
 * Key Security Decisions:
 * - Public Read Access: The `/predictions` collection is fully readable by anyone,
 *   including anonymous users, to support the "Today's Tips" and "30-Day Tips" views.
 * - No Client Writes: All client-side write operations (create, update, delete) are
 *   explicitly denied. This is a critical security measure to protect the integrity
 *   of the prediction data from unauthorized changes.
 * - Backend-Managed Data: The rules are designed with the assumption that a trusted
 *   server-side process is responsible for managing the lifecycle of prediction documents.
 *
 * Denormalization for Authorization:
 * This principle is not applicable to this ruleset, as there is no user-specific
 * ownership or role-based access control that would require denormalization.
 *
 * Structural Segregation:
 * This principle is not applicable, as all data is public. There is no need to
 * segregate public and private data into different collections.
 */
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    /**
     * @description
     * Allows public, read-only access to all predictions. All write operations
     * are denied to prevent any client-side data manipulation.
     * @path
     * `/predictions/{predictionId}`
     * @allow
     * An anonymous user reads a specific prediction: `(get)` `/predictions/some-prediction-id`.
     * @deny
     * Any user (anonymous or authenticated) attempts to create a new prediction: `(create)` `/predictions/new-prediction`.
     * @principle
     * Secures a public dataset by making it read-only for clients. Data integrity is maintained by a trusted backend process.
     */
    match /predictions/{predictionId} {
      allow get: if true;
      allow list: if true;
      allow create: if false;
      allow update: if false;
      allow delete: if false;
    }
  }
}